<style>
  /*  ---------- CSS del usuario ------------ */

  .reference .title {
    display: none;
  }

  .li-group {
    background-color: black;
  }
</style>

<template id="wc-dynamic-table">
  <!-- <link rel="stylesheet" href="styles.css"> -->
  <style>
    :host {
      width: 70%;
      min-height: 250px;
      height: 250px;
      background-color: blue;
      display: block;
      margin: 0 auto;
    }

    /* Si encuentra un elemento o selector en alguno de sus antecesores */

    :host-context(.device-mobile) {
      width: 50%;
    }

    .min-format-test {
      min-width: 100px;
      min-height: 100px;
      height: auto;
      width: auto;
      display: block;
    }

    #reference-wrapper {
      background-color: red;
    }

    #reference-wrapper>slot {
      display: block;
    }

    #reference-wrapper>slot::slotted(.reference) {
      display: block;
    }

    #description-wrapper {
      background-color: orange;
      overflow: auto;
    }

    #description-wrapper>slot {
      display: block;
    }

    /* --------- Vertical orientation RULES --------- */

    :host([orientation="vertical"]) #reference-wrapper {
      display: inline-block;
      width: 20%;
      height: 100%;
      overflow: auto;
    }

    :host([orientation="vertical"]) #description-wrapper {
      display: inline-block;
      width: 80%;
      height: 100%;
    }

    /* --------- Horizontal orientation RULES --------- */

    :host([orientation="horizontal"]) #slot_reference::slotted(.reference) {
      display: inline-block;
    }

    :host([orientation="horizontal"]) #slot_reference::slotted() {
      display: none;
    }

    :host([orientation="horizontal"]) #reference-wrapper {
      display: block;
      width: 100%;
      height: 20%;
    }

    :host([orientation="horizontal"]) #description-wrapper {
      display: block;
      width: 100%;
      height: 80%;
    }
  </style>

  <article id="reference-wrapper">
    <slot id="slot_reference" name="reference" class="title"></slot>
  </article>

  <article id="description-wrapper">
    <slot id="slot_description" name="description" class="description"> </slot>
  </article>

</template>

<script>
  "strict mode";
  class WcDynamicTable extends HTMLElement {
    constructor(orientation = "horizontal", sortBy = "order") {
      super();

      console.log("constructor");

      this.sortBy = sortBy;
      this.orientation = orientation;

      const shadowRoot = this.attachShadow({
        mode: "open"
      });
      const DOMdoc = document.currentScript.ownerDocument;

      shadowRoot.innerHTML = DOMdoc.getElementById("wc-dynamic-table").innerHTML
    }

    static get observedAttributes() {
      return ["orientation"];
    }

    connectedCallback() {
      console.log("connectedCallback");

      let references_slot = this.shadowRoot.querySelector(
        "#reference-wrapper > slot"
      );
      let references_list = references_slot.assignedNodes();
      let i = 0;

      for (i; i <= references_list.length - 1; i++) {
        references_list[i].setAttribute("wc-index", i);
      }

      let descriptions_slot = this.shadowRoot.querySelector(
        "#description-wrapper > slot"
      );
      let descriptions_list = descriptions_slot.assignedNodes({
        flatten: true
      });
      i = 0;

      for (i; i <= descriptions_list.length - 1; i++) {
        descriptions_list[i].setAttribute("wc-index", i);
      }
    }

    onRefereceClick(e) {
      this.setAttribute("selected");
    }

    disconnectedCallback() {
      console.log("DisconnectedCallback");
    }

    attributeChangedCallback(attrName, oldVal, newVal) {
      console.log("attributeChangedCallback");

      if (attrName === "orientation") {
        if (newVal !== "vertical" && newVal !== "horizontal") {
          this.orientation = "vertical";
        }
      }
    }

    // Get && Set Orientation
    get orientation() {
      if (this.hasAttribute("orientation")) {
        return this.getAttribute("orientation");
      }
      return false;
    }

    set orientation(value) {
      if (value) {
        this.setAttribute("orientation", value);
      } else {
        this.removeAttribute("orientation");
      }
    }
  }

  customElements.whenDefined("wc-dynamic-table").then(() => {
    console.log("wc-dynamic-table defined");
  });

  window.customElements.define("wc-dynamic-table", WcDynamicTable);

</script>